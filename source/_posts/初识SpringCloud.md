---
title: 初识SpringCloud
top: false
cover: false
toc: true
mathjax: false
date: 2024-07-04 09:06:57
author:
img:
coverImg:
password:
summary:
tags:
categories:

---

# 初识微服务

## 单体架构

{% asset_img 单体架构.png 单体架构 %}

> 将业务的所有功能`集中在一个项目中开发`，`打成一个包部署`。
>
> **优点：**架构简单；部署成本低
>
> **缺点：**耦合度高（维护困难、升级困难）
>
> 1. 整体性
>    - 单体架构将整个应用程序作为单一的、紧密耦合的单元
>    - 所有模块和组件都部署在同一个应用实例中，共享同一个进程和数据库
> 2. 开发简单：
>    - 单体架构通常简单，开发者只需要关注一个代码库和一个部署单元
> 3. 部署容易
>    - 部署单体应用相对简单，通常只需要将整个应用部署到一个应用服务器或者容器中
> 4. 维护简单
>    - 在一般情况下，单体应用的维护都较为简单，整个应用都在一个代码库中
> 5. 扩展受限
>    - 随着业务规模的扩大，单体架构会变得难以维护和扩展

## 分布式架构
{% asset_img 分布式架构.png 分布式架构 %}

> 根`据业务功能对系统做拆分`，每个业务功能模块作为独立项目开发，称为`一个服务`。
>
> **优点：**降低服务耦合；有利于服务升级和拓展
>
> **缺点：**`服务调用关系错综复杂`
>
> 1. 模块化和分布
>    - 分布式架构将系统分为多个独立的模块或服务，每个模块都可以运行在不同的进程、服务器或者容器中
> 2. 独立部署开发
>    - 各模块可以独立开发、测试和部署，提高了团队的独立性和协作效率
> 3. 扩展灵活
>    - 分布式系统更容易实现水平扩展，通过增加节点或服务来提高系统性能和容量
> 4. 高可用性
>    - 分布式系统通过在不同地理位置上运行模块组成集群来提高可用性，防止单点故障

## 微服务架构

{% asset_img 微服务架构.png  微服务架构 %}

> **微服务**是一种经过良好架构设计的**分布式架构方案** 。其特点如下
>
> - `单一职责`：微服务拆分粒度更小，`每一个服务都对应唯一的业务能力`，做到单一职责
> - `自治`：团队独立、技术独立、数据独立，`独立部署和交付`
> - `面向服务`：`务提供统一标准的接口`，与语言和技术无关
> - `隔离性强`：服务调用做好`隔离、容错、降级，避免出现级联问题`
>
> 1. 服务化
>    - 微服务架构是一种分布式架构的变体，将系统拆分为小而自治的服务
>    - 每个服务都有自己的数据存储和业务逻辑，可以独立开发、测试、部署和扩展
> 2. 独立演化
>    - 微服务允许不同的服务独立演化和更新，而不会对整个系统产生影响
>    - 每个微服务都可以用不同的技术栈
> 3. 弹性和可伸缩
>    - 微服务可以独立的弹性和可伸缩的扩展，以应对不同服务的不同需求
> 4. 有限的一致性
>    - 微服务架构通常采用分布式数据管理，可能存在一致性问题，需要通过事务补偿等手段来解决
> 5. 服务发现和治理
>    - 微服务需要一种机制来进行服务发现和治理，确保服务之间的通信和协作
> 6. 复杂性
>    - 尽管微服务提供了灵活性和独立性，但是引入了分布式系统的复杂性，需要面对服务之间的的通信、容错、一致性等问题

## 总结

> 1. 单体架构：简单方便，高度耦合，扩展性差，适合小型项目。例如：学生管理系统
>
> 2. 分布式架构：松耦合，扩展性好，但架构复杂，难度大。适合大型互联网项目，例如：京东、淘宝
>
> 3. 微服务：一种良好的分布式架构方案
>
>    ①优点：拆分粒度更小、服务更独立、耦合度更低
>
>    ②缺点：架构非常复杂，运维、监控、部署难度提高
>
>    SpringCloud是微服务架构的一站式解决方案，集成了各种优秀微服务功能组件

# SpringCloud
{% asset_img 4.png img %}
{% asset_img SpringCloud组成.png  SpringCloud组成 %}

## 定义

> 1. 基于 Spring Boot 的 Spring 集成应用程序，它利用 Spring Boot 的开发便利性简化了分布式系统的开发，提供与外部系统的集成。 如服务注册与发现、配置中心、负载均衡、断路器、消息总线、数据监控等；换句话说：Spring Cloud 提供了构建分布式系统所需的“全家桶”。
> 2. Spring cloud Task，一个生命周期短暂的微服务框架，用于快速构建执行有限数据处理的应用程序
> 3. springcloud是一种架构，一种思想，分布式，云架构，不专注于CRUD；springcloud就相当于乐高积木

## 核心组件

> 核心组件含：
>
> - **服务注册与发现：**如Eureka、Nacos、Consul。
> - **服务远程调用：**如OpenFeign、Dubbo。
> - **负载均衡：**如Ribbon。
> - **服务熔断（流控、降级、保护）：**如Hystrix、Sentinel。
> - **统一网关路由：**如 Zuul 网关转发请求给对应的服务。

### 服务注册与发现（Eureka）

{% asset_img Eureka.png  Eureka %}

> Eureka是Netflix公司开发的一款基于REST的服务发现框架，它主要用于在微服务架构中实现服务注册与发现、负载均衡和故障转移等功能。以下是Eureka的详细介绍：
>
> 一、Eureka的基本概念和架构
>
> Eureka采用了客户端/服务端（C-S）的设计架构，主要包括两个组件：Eureka Server（服务端）和Eureka Client（客户端）。
>
> - **Eureka Server**：作为服务注册中心，负责接收来自Eureka Client的注册请求，并维护一个服务注册表，该注册表记录了所有已注册的服务实例的信息，包括实例ID、主机名、IP地址、端口号等。Eureka Server还负责监控服务实例的健康状态，并在实例不可用时从注册表中移除。
> - **Eureka Client**：运行在微服务实例中的组件，负责向Eureka Server注册服务实例并定期发送心跳以确认其健康状态。Eureka Client还提供了内置的负载均衡器，可以根据负载均衡算法选择合适的实例进行调用。
>
> 二、Eureka的主要功能
>
> 1. **服务注册与发现**：Eureka允许微服务在运行时注册自己，并允许其他微服务通过Eureka Server查询可用的服务实例。这样，服务消费者就可以通过Eureka Server获取服务提供者的地址信息，从而实现服务的动态发现和调用。
> 2. **负载均衡**：Eureka支持基于名称的负载均衡，允许客户端通过服务名称来查询可用的服务实例，并使用负载均衡算法（如轮询、随机、加权轮询等）选择合适的实例进行调用。
> 3. **故障转移**：当服务实例不可用时，Eureka Server会将其从注册表中移除，并通知其他微服务进行故障转移和恢复。这样，系统就可以自动地实现服务的故障转移，提高系统的可用性和稳定性。
> 4. **高可用性和容错性**：Eureka支持集群部署和自动故障转移，具有较高的可用性和容错性。在集群部署中，Eureka Server之间通过复制的方式完成数据的同步，确保数据的一致性和可靠性。
>
> 三、Eureka的优点
>
> 1. **高可用性**：Eureka具有集群和负载均衡的能力，能够提供高可用性的服务注册和发现机制。
> 2. **易于使用**：Eureka提供了简单的API和UI界面，使得开发人员可以方便地进行服务注册和发现。
> 3. **扩展性强**：Eureka的设计原则是可扩展性，可以方便地添加新的服务节点或新增服务实例。
> 4. **配置灵活**：Eureka提供了各种配置选项，可以根据实际需求进行自定义配置，满足不同场景的需求。
> 5. **自我保护机制**：Eureka具有自我保护机制，即使在网络异常或部分节点故障的情况下，也能保持服务的可用性。
>
> 四、Eureka的缺点
>
> 1. **单点故障**：Eureka默认情况下使用了一个单节点的注册中心，如果该节点发生故障，会导致整个系统的服务注册和发现功能不可用。不过，通过集群部署可以解决这个问题。
> 2. **监控和容错能力较弱**：Eureka的监控和容错能力相对较弱，缺乏对服务的健康状态监控和故障转移机制的支持。这需要结合其他组件或工具来实现更全面的监控和容错。
> 3. **维护成本较高**：由于Eureka的架构比较复杂，需要维护多个节点和实例，增加了系统的维护成本和复杂度。
> 4. **依赖性较强**：Eureka是Netflix公司的开源项目，对于非Netflix的应用来说，使用Eureka可能需要解决一些依赖性问题。
>
> 五、Eureka的应用场景
>
> Eureka非常适合用于微服务架构中，特别是在服务数量较多、服务调用关系复杂的情况下。通过Eureka，可以方便地实现服务的注册、发现和调用，提高系统的可维护性和可扩展性。同时，Eureka还可以与Spring Cloud等框架集成，提供更加丰富和强大的功能支持。
